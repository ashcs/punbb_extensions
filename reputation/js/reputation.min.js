/*
 http://www.gnu.org/licenses/gpl.html GPL version 2 or higher
 @package reputation
*/
$(function(){function a(a,b){$.ajax({url:e,type:"GET",cache:false,dataType:"json",timeout:3E3,success:function(a){$("#tooltip_content").html(a.message);b()},error:function(){$("#tooltip_content").html(data.message);b()}});return false}function i(c){var f=$(c).attr("rel");if(d)if(f!=e)b.css("display","none");else return h();e=f;var g=$(c).offset();a(c,function(){b.css({top:g.top-b.height()+10,left:g.left-b.width()/2+$(c).width()/2,display:"block"}).animate({top:"-=10px",opacity:1},250,"swing",function(){d=
true})});return false}function h(){if(!d)return false;b.animate({top:"-=10px",opacity:0},250,"swing",function(){d=false;b.css("display","none")});return false}var d=false,e=null;$("#brd-wrap").append('<table class="rep_popup"><tbody><tr><td id="topleft" class="corner"></td><td class="top"></td><td id="topright" class="corner"></td></tr><tr><td class="left"></td><td id="tooltip_content"></td><td class="right"></td></tr><tr><td class="corner" id="bottomleft"></td><td class="bottom"><span class="arrow"><\!-- //--\></span></td><td id="bottomright" class="corner"></td></tr></tbody></table>');
var b=$(".rep_popup").css("opacity",0);$(".rep_plus_minus a").click(function(a){a.stopPropagation();i(this)});$("body").click(function(){h()})});
var reputation={response:{},url:"",updateTips:function(a){$(".validateTips").html(a).addClass("ui-state-highlight");setTimeout(function(){$(".validateTips").removeClass("ui-state-highlight",1500)},500)},send_data:function(){$.ajax({url:reputation.url,type:"POST",cache:false,data:{csrf_token:reputation.response.csrf_token,form_sent:1,req_message:$("#rep_form_reason").val()},dataType:"json",timeout:3E3,success:function(a){a.error!=void 0?(reputation.updateTips(a.error),$("#rep_form_reason").addClass("ui-state-error")):
a.message!=void 0?($("#rep_form").dialog("close"),alert(a.message)):a.destination_url!=void 0?window.location=a.destination_url:window.location.reload(true)},error:function(){alert("error!");window.location=reputation.url}})},show_form:function(a){$("#rep_form_description").html(a.description);$("#rep_form").dialog({height:"auto",width:350,title:a.title,show:"fade",hide:"fade",resizable:false,modal:true,buttons:[{text:a.submit,click:function(){reputation.send_data()}}],close:function(){$(".validateTips").empty();
$("#rep_form_reason").val("").removeClass("ui-state-error")}})},init:function(){$(document).ready(function(){$("#brd-wrap").append('<div id="rep_form" style="display:none;pading:0 0;"><p id="rep_form_description"></p><p class="validateTips"></p><textarea style="width:97%;height:118px" id="rep_form_reason" /></div><div id="rep_error" style="display:none;pading:0 0;"><p></p></div>');$(".rep_info_link").click(function(){reputation.url=$(this).attr("href");$.ajax({url:reputation.url,type:"GET",cache:false,
dataType:"json",timeout:3E3,success:function(a){(a.code=a.message!=void 0)?($("#rep_error").dialog({resizable:false}),$("#rep_error p").html(a.message)):(reputation.response=a,reputation.show_form(a))},error:function(){window.location=reputation.url}});return false})})}};reputation.init();
